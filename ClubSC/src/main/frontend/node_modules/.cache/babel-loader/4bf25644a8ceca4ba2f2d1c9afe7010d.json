{"ast":null,"code":"import _regeneratorRuntime from\"/Users/cdrlao/Desktop/ClubSC/ClubSC/src/main/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/cdrlao/Desktop/ClubSC/ClubSC/src/main/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/cdrlao/Desktop/ClubSC/ClubSC/src/main/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{useState,useEffect}from'react';import axios from'axios';import ContainerView from'../components/ContainerView';import InputField from'../components/InputField';import Link from'../components/Link';var LoginPage=function LoginPage(_ref){var user=_ref.user,setUser=_ref.setUser;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),invalidLogin=_useState6[0],setInvalidLogin=_useState6[1];useEffect(function(){if(user){window.history.pushState({},'','/');var navEvent=new PopStateEvent('popstate');window.dispatchEvent(navEvent);}});var handleLogin=function handleLogin(e){var login=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(user,pw){var _yield$axios$post,data,navEvent;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.post('http://localhost:8080/api/auth/signin',{username:user,password:pw});case 3:_yield$axios$post=_context.sent;data=_yield$axios$post.data;localStorage.setItem(\"user\",JSON.stringify(data));setInvalidLogin(false);setUser(JSON.parse(localStorage.getItem('user')));if(data.roles.includes('ROLE_STUDENT')){window.history.pushState({},'',\"/userdash\");}else{window.history.pushState({},'',\"/clubdash\");}navEvent=new PopStateEvent('popstate');window.dispatchEvent(navEvent);_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);setInvalidLogin(true);case 16:case\"end\":return _context.stop();}}},_callee,null,[[0,13]]);}));return function login(_x,_x2){return _ref2.apply(this,arguments);};}();e.preventDefault();login(username,password);};return/*#__PURE__*/_jsx(ContainerView,{logoOnly:true,user:undefined,children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row d-flex flex-row justify-content-center align-items-center\",style:{height:'60vh'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-10 col-md-8 col-lg-5\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"my-3\",style:{textAlign:'center'},children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Log In\"}),invalidLogin?/*#__PURE__*/_jsx(\"p\",{className:\"text-danger\",children:\"Invalid Login\"}):null]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleLogin,children:[/*#__PURE__*/_jsx(InputField,{className:\"my-4\",type:\"text\",title:\"Username\",onChange:setUsername}),/*#__PURE__*/_jsx(InputField,{className:\"my-4\",type:\"password\",title:\"Password\",onChange:setPassword}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-row justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(Link,{className:\"mr-auto ml-1\",href:\"/signup\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"hide-mobile\",children:\"Don't have an account?\"}),/*#__PURE__*/_jsx(\"span\",{className:\"show-mobile\",children:\"Sign Up\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary ml-auto mr-1\",type:\"Submit\",children:\"Submit\"})]})]})]})})})});};export default LoginPage;","map":{"version":3,"sources":["/Users/cdrlao/Desktop/ClubSC/ClubSC/src/main/frontend/src/pages/LoginPage.js"],"names":["React","useState","useEffect","axios","ContainerView","InputField","Link","LoginPage","user","setUser","username","setUsername","password","setPassword","invalidLogin","setInvalidLogin","window","history","pushState","navEvent","PopStateEvent","dispatchEvent","handleLogin","e","login","pw","post","data","localStorage","setItem","JSON","stringify","parse","getItem","roles","includes","preventDefault","undefined","height","textAlign"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport ContainerView from '../components/ContainerView';\nimport InputField from '../components/InputField';\nimport Link from '../components/Link';\n\nconst LoginPage = ( { user, setUser } ) => {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [invalidLogin, setInvalidLogin] = useState(false);\n\n  useEffect(() => {\n    if(user){\n      window.history.pushState({}, '', '/');\n      const navEvent = new PopStateEvent('popstate');\n      window.dispatchEvent(navEvent);\n    }\n  });\n\n  const handleLogin = (e) => {\n    const login = async (user, pw) => {\n      try {\n        const { data } = await axios.post('http://localhost:8080/api/auth/signin',\n          {\n            username: user,\n            password: pw\n          }\n        )\n\n        localStorage.setItem(\"user\", JSON.stringify(data));\n\n        setInvalidLogin(false);\n        setUser(JSON.parse(localStorage.getItem('user')));\n\n        if(data.roles.includes('ROLE_STUDENT')){\n          window.history.pushState({}, '', `/userdash`);\n        } else{\n          window.history.pushState({}, '', `/clubdash`);\n        }\n\n        const navEvent = new PopStateEvent('popstate');\n        window.dispatchEvent(navEvent);\n\n      } catch {\n        setInvalidLogin(true);\n      }\n    }\n\n    e.preventDefault();\n    login(username, password);\n  };\n\n\n  return (\n    <ContainerView logoOnly={true} user={undefined}>\n    <div className=\"container\">\n    <div className=\"row d-flex flex-row justify-content-center align-items-center\" style={{height:'60vh'}}>\n        <div className=\"col-10 col-md-8 col-lg-5\">\n          <div className=\"my-3\" style={{ textAlign:'center'}}>\n            <h1>Log In</h1>\n            {invalidLogin ? <p className=\"text-danger\">Invalid Login</p> : null}\n          </div>\n          <form onSubmit={handleLogin}>\n            <InputField\n              className=\"my-4\"\n              type=\"text\"\n              title=\"Username\"\n              onChange={setUsername}\n            />\n            <InputField\n              className=\"my-4\"\n              type=\"password\"\n              title=\"Password\"\n              onChange={setPassword}\n            />\n            <div className=\"d-flex flex-row justify-content-between align-items-center\">\n              <Link className=\"mr-auto ml-1\" href=\"/signup\">\n                <span className=\"hide-mobile\">Don't have an account?</span>\n                <span className=\"show-mobile\">Sign Up</span>\n              </Link>\n              <button className=\"btn btn-primary ml-auto mr-1\" type=\"Submit\">Submit</button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n    </ContainerView>\n  );\n};\n\nexport default LoginPage;\n"]},"metadata":{},"sourceType":"module"}