{"ast":null,"code":"import _regeneratorRuntime from\"/Users/cdrlao/Desktop/ClubSC/ClubSC/src/main/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/cdrlao/Desktop/ClubSC/ClubSC/src/main/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/cdrlao/Desktop/ClubSC/ClubSC/src/main/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{useState,useEffect}from'react';import axios from'axios';import Post from'../components/Post';import InputArea from'../components/InputArea';import ContainerView from'../components/ContainerView';import{authHeader}from'../App';var ClubDashboard=function ClubDashboard(_ref){var user=_ref.user,setUser=_ref.setUser;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),description=_useState4[0],setDescription=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),announcements=_useState6[0],setAnnouncements=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),postText=_useState8[0],setPostText=_useState8[1];useEffect(function(){if(!user||user.roles.includes('ROLE_STUDENT')){window.history.pushState({},'','/');var navEvent=new PopStateEvent('popstate');window.dispatchEvent(navEvent);}});useEffect(function(){var getClubInfo=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$post,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.post(\"http://localhost:8080/app/clubpage\",{key:user.id});case 2:_yield$axios$post=_context.sent;data=_yield$axios$post.data;setName(data.club_name);setDescription(data.club_desc);setAnnouncements(data.announcements);case 7:case\"end\":return _context.stop();}}},_callee);}));return function getClubInfo(){return _ref2.apply(this,arguments);};}();getClubInfo();},[]);var makePost=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var _yield$axios$post2,announcements;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();if(!(postText.length<20)){_context2.next=3;break;}return _context2.abrupt(\"return\");case 3:axios.post(\"http://localhost:8080/app/clubpost\",{content:postText},{headers:authHeader()});_context2.next=6;return axios.post(\"http://localhost:8080/app/clubpage\",{key:user.id});case 6:_yield$axios$post2=_context2.sent;announcements=_yield$axios$post2.data.announcements;setAnnouncements(announcements);case 9:case\"end\":return _context2.stop();}}},_callee2);}));return function makePost(_x){return _ref3.apply(this,arguments);};}();var renderedAnnouncements=announcements.map(function(a){return/*#__PURE__*/_jsx(Post,{timestamp:a.timestamp,red:true,children:/*#__PURE__*/_jsx(\"p\",{children:a.body})},a.postid);});return/*#__PURE__*/_jsx(ContainerView,{logoOnly:true,user:user,setUser:setUser,children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column justify-content-center align-items-center\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"mt-4\",children:name}),/*#__PURE__*/_jsx(\"p\",{children:description})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(Post,{club:\"Club Name\",red:true,children:/*#__PURE__*/_jsx(\"form\",{onSubmit:makePost,children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column justify-content-center align-items-fill\",children:[/*#__PURE__*/_jsx(InputArea,{placeholder:\"Make a new post\",onChange:setPostText,className:\"mb-0 mt-2\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary mt-0 mb-4\",children:\"Post\"})]})})}),renderedAnnouncements]})});};export default ClubDashboard;","map":{"version":3,"sources":["/Users/cdrlao/Desktop/ClubSC/ClubSC/src/main/frontend/src/pages/ClubDashboard.js"],"names":["React","useState","useEffect","axios","Post","InputArea","ContainerView","authHeader","ClubDashboard","user","setUser","name","setName","description","setDescription","announcements","setAnnouncements","postText","setPostText","roles","includes","window","history","pushState","navEvent","PopStateEvent","dispatchEvent","getClubInfo","post","key","id","data","club_name","club_desc","makePost","e","preventDefault","length","content","headers","renderedAnnouncements","map","a","timestamp","body","postid"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport Post from '../components/Post';\nimport InputArea from '../components/InputArea';\nimport ContainerView from '../components/ContainerView';\nimport { authHeader } from '../App';\n\nconst ClubDashboard = ({ user, setUser }) => {\n  const [ name, setName ] = useState('');\n  const [ description, setDescription ] = useState('');\n  const [ announcements, setAnnouncements ] = useState([]);\n  const [ postText, setPostText ] = useState([]);\n\n  useEffect(() => {\n    if(!user || user.roles.includes('ROLE_STUDENT')){\n      window.history.pushState({}, '', '/');\n      const navEvent = new PopStateEvent('popstate');\n      window.dispatchEvent(navEvent);\n    }\n  });\n\n  useEffect(() => {\n    const getClubInfo = async () => {\n      const { data } = await axios.post(\"http://localhost:8080/app/clubpage\",\n        {\n          key: user.id\n        }\n      );\n\n      setName(data.club_name);\n      setDescription(data.club_desc);\n      setAnnouncements(data.announcements);\n    }\n\n    getClubInfo();\n  }, []);\n\n  const makePost = async (e) => {\n    e.preventDefault();\n\n    if(postText.length < 20) { return; }\n\n    axios.post(\"http://localhost:8080/app/clubpost\",\n      {\n        content: postText\n      },\n      { headers: authHeader() });\n\n    const { data: {announcements} } = await axios.post(\"http://localhost:8080/app/clubpage\",\n      {\n        key: user.id\n      }\n    );\n\n    setAnnouncements(announcements);\n  }\n\n  const renderedAnnouncements = announcements.map((a) => {\n    return (\n      <Post key={a.postid} timestamp={a.timestamp} red={true}>\n        <p>{a.body}</p>\n      </Post>\n    );\n  });\n\n  return (\n    <ContainerView logoOnly={true} user={user} setUser={setUser}>\n      <div className=\"container\">\n        <div className=\"d-flex flex-column justify-content-center align-items-center\">\n          <h1 className=\"mt-4\">{name}</h1>\n          <p>{description}</p>\n        </div>\n        <hr />\n        <Post club=\"Club Name\" red={true}>\n          <form onSubmit={makePost}>\n            <div className=\"d-flex flex-column justify-content-center align-items-fill\">\n              <InputArea placeholder=\"Make a new post\" onChange={setPostText} className=\"mb-0 mt-2\"/>\n              <button className=\"btn btn-secondary mt-0 mb-4\">Post</button>\n            </div>\n          </form>\n        </Post>\n        {renderedAnnouncements}\n      </div>\n    </ContainerView>\n  );\n};\n\nexport default ClubDashboard;\n"]},"metadata":{},"sourceType":"module"}